<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
    color: #333;
    background: #fff;
  }

  /* --- Header --- */

  .header-container {
    position: sticky;
    top: 0;
    z-index: 100;
    background: #fff;
    transition: all 0.3s ease;
  }

  .header-actions {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0.75rem 1.5rem;
    height: 60px;
    transition: all 0.3s ease;
  }

  .header-actions-left,
  .header-actions-right {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .header-logo {
    position: relative;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .home-icon,
  .logo-icon {
    width: 24px;
    height: 24px;
    position: absolute;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  .logo-icon {
    opacity: 0;
    transform: scale(0.5);
    background: #0d7c84;
    color: white;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 18px;
  }

  .masthead {
    text-align: center;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    transform-origin: top;
    padding: 2rem 1rem;
  }

  .logo {
    font-size: 3rem;
    font-weight: 300;
    margin-bottom: 0.5rem;
    letter-spacing: 2px;
  }

  .logo-accent {
    background: #0d7c84;
    border-radius: 4px;
    color: white;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: 500;
    line-height: 1;
    text-align: center;
    padding-left: 3px;
    overflow: hidden;
    transform: translateY(-10px);
    width: 40px;
    height: 40px;
  }

  .tagline {
    color: #666;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 1rem;
  }

  .navbar {

    transition: all 0.3s ease;
  }

  .navbar-menu {
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: center;
    gap: 2rem;
    list-style: none;
    width: max-content;
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem 1.5rem;
    transition: all 0.3s ease;
  }

  .scrolled .navbar-menu {
    border-bottom: 0;
  }

  .navbar-item {
    color: #666;
    text-decoration: none;
    transition: color 0.2s ease;
    font-size: 0.95rem;
  }

  .navbar-item:hover {
    color: #0D7C84;
  }

  /* --- Scrolled State --- */

  .header-container.scrolled {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.07);
    border-bottom: 1px solid #e9ecef;
  }

  .header-container.scrolled .home-icon {
    opacity: 0;
    transform: scale(0.5);
  }

  .header-container.scrolled .logo-icon {
    opacity: 1;
    transform: scale(1);
  }

  .header-container.scrolled .masthead,
  .header-container.scrolled .navbar {
    display: none;
  }

  .header-container.scrolled .header-actions {
    justify-content: flex-start;
  }

  /* The moved menu */
  .header-container.scrolled .navbar-menu {
    padding: 0;
    margin: 0;
    flex-grow: 1;
    justify-content: center;
  }

  /* --- Other Components --- */
  .support-btn {
    background: #0d7c84;
    color: white;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 0.9rem;
  }

  .support-btn:hover {
    background: #235a66;
    transform: translateY(-1px);
  }

  .search-icon {
    width: 24px;
    height: 24px;
    cursor: pointer;
    color: #0D7C84;
  }

  /* --- Content & Responsive (unchanged) --- */
  .article-hero {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 1rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    align-items: center;
  }

  .article-image {
    width: 100%;
    height: 400px;
    object-fit: cover;
    border-radius: 8px;
  }

  .article-content h1 {
    font-size: 2.5rem;
    font-weight: 400;
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  .article-meta {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  .author {
    color: #999;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .demo-content {
    height: 200vh;
    padding: 2rem;
    max-width: 800px;
    margin: 0 auto;
  }

  .demo-content h2 {
    margin: 2rem 0 1rem;
    color: #0D7C84;
  }

  .demo-content p {
    margin-bottom: 1rem;
    color: #555;
  }

  @media (max-width: 768px) {
    .navbar-menu {
      gap: 1rem;
    }

    .navbar-item {
      font-size: 0.9rem;
    }

    .article-hero {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }

    .article-content h1 {
      font-size: 2rem;
    }
  }
</style>

<div class="header-container" id="header-container">
  <section class="header" aria-label="Поддержите проект">
    <div class="header-actions">
      <div class="header-actions-left">
        <div class="header-logo">
          <svg class="home-icon" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9,22 9,12 15,12 15,22"></polyline>
          </svg>
          <div class="logo-icon">M</div>
        </div>
        <svg class="search-icon" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </div>
      <div class="header-actions-right">
        <button class="support-btn">поддержать</button>
      </div>
    </div>
  </section>

  <header class="masthead" id="masthead">
    <div class="masthead-main">
      <div class="logo">
        MOST
        <span class="logo-accent"> M </span>
        МЕДИА
      </div>
      <div class="tagline">Кооператив независимых издателей</div>
    </div>
  </header>

  <nav class="navbar">
    <ul class="navbar-menu">
      <li>
        <a class="navbar-item" href="#"> Политика </a>
      </li>
      <li>
        <a class="navbar-item" href="#"> Конфликты </a>
      </li>
      <li>
        <a class="navbar-item" href="#"> Экономика </a>
      </li>
      <li>
        <a class="navbar-item" href="#"> Мнения </a>
      </li>
      <li>
        <a class="navbar-item" href="#"> Культура </a>
      </li>
      <li>
        <a class="navbar-item" href="#"> Спецпроекты </a>
      </li>
    </ul>
  </nav>
</div>

<main>
  <section class="article-hero">
    <img alt="Министерство культуры" class="article-image" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='600' height='400' viewBox='0 0 600 400'%3E%3Crect width='600' height='400' fill='%23ddd'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='0.3em' font-family='sans-serif' font-size='18' fill='%23999'%3EМинистерство культуры%3C/text%3E%3C/svg%3E" />
    <div class="article-content">
      <h1>Один день министерства культуры в эпоху «СВО»</h1>
      <div class="article-meta">Репортаж специального корреспондента «Моста»</div>
      <div class="author">Автор: ЖЕНЯ КРОПИВНИЦКИ</div>
    </div>
  </section>
  <div class="demo-content">
    <h2>Прокрутите страницу вверх</h2>
    <p>Обратите внимание, как навигация становится липкой, появляется тень, а иконка "домик" плавно трансформируется в логотип "M".</p>
    <h2>Особенности анимации</h2>
    <p>Анимация использует современные CSS-переходы и JavaScript для отслеживания прокрутки. Все элементы анимируются с помощью transform и opacity для лучшей производительности.</p>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.</p>
    <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
    <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt.</p>
  </div>
</main>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const headerContainer = document.getElementById('header-container');
    const navbar = document.querySelector('.navbar');
    const navbarMenu = document.querySelector('.navbar-menu');
    const headerActions = document.querySelector('.header-actions');
    const headerActionsRight = document.querySelector('.header-actions-right');

    if (!headerContainer || !navbarMenu || !headerActions || !headerActionsRight) {
      console.error('Header elements not found');
      return;
    }

    const SCROLL_TRIGGER_OFFSET = 1;

    const updateHeaderState = () => {
      const isScrolled = window.pageYOffset > SCROLL_TRIGGER_OFFSET;
      const isMenuMoved = navbarMenu.parentElement === headerActions;

      headerContainer.classList.toggle('scrolled', isScrolled);

      if (isScrolled && !isMenuMoved) {
        // Move menu into the actions bar, before the right-side controls
        headerActions.insertBefore(navbarMenu, headerActionsRight);
        headerActions.style.justifyContent = 'space-between';
      } else if (!isScrolled && isMenuMoved) {
        // Move it back to its original container
        navbar.appendChild(navbarMenu);
        headerActions.style.justifyContent = '';
      }
    };

    let ticking = false;
    const handleScroll = () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          updateHeaderState();
          ticking = false;
        });
        ticking = true;
      }
    };

    window.addEventListener('scroll', handleScroll);
    updateHeaderState(); // Initial check
  });
</script>
